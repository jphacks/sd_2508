# サンプル（プロダクト名）

[![IMAGE ALT TEXT HERE](https://jphacks.com/wp-content/uploads/2025/05/JPHACKS2025_ogp.jpg)](https://www.youtube.com/watch?v=lA9EluZugD8)

## 製品概要

### 背景(製品開発のきっかけ、課題等）

近年、子供の車・バス置き去りによる熱中症・死亡、また、園からの脱走による事故が起きています。このシステムではスマートフォンを持たない幼児や高齢者といった被保護者を、保護者が遠隔から見守ることができます。LoRaWAN カードトラッカーと BLE ビーコン、GPS などを組み合わせることで屋内や屋外、乗り物の中といった異なる環境下でも情報を web アプリケーション上で提供して、安心を届けることを目指しております。

#### 課題

| Case   | 想定される課題           | 詳細                                                                             |
| ------ | ------------------------ | -------------------------------------------------------------------------------- |
| CASE 1 | 建物の外に出た場合の検出 | GPS 単独では屋内外の判別が困難。園や施設の出入口を越えたことを正確に検出したい。 |
| CASE 2 | 外に出てしまった後の追跡 | BLE の通信範囲を超えると、屋外での位置追跡ができない。長距離通信が必要。         |

#### 解決

- 屋内検知: BLE ビーコンを利用した電波強度（RSSI）からの三点測位で、おおよその部屋・建物内位置を推定。

- 屋外追跡: LoRaWAN 通信と GPS を用いて、外出後でも位置情報を低消費電力で定期送信。

- Web アプリでの一元管理: 屋内・屋外の位置データを統合し、地図や平面図上に可視化。

### 製品説明（具体的な製品の説明）

![System Flow](diagram.drawio.svg)

### 特長

#### 1. 特長 1

ハイブリッド測位技術の採用: システムの最大の特徴は、3 つの異なる通信技術を適材適所で使い分けるハイブリッド構成です。

- LoRaWAN: カードトラッカーからゲートウェイへの長距離・低消費電力なデータ通信のバックボーンとして活用

- BLE: 屋内や車内など、GPS が不得意な閉空間での近距離・高精度な測位に使用

**ハイブリッドな測位技術**: システムの最大の特徴は、3つの異なる通信技術を適材適所で使い分けるハイブリッド構成です。
- LoRaWAN: カードトラッカーからゲートウェイへの長距離・低消費電力なデータ通信のバックボーンとして活用
- BLE: 屋内や車内など、GPSが不得意な閉空間での近距離・高精度な測位に使用
- GPS: 屋外での広範囲な位置特定に使用

#### 2. 特長 2
**シナリオに基づいた3つのモード切り替え機能**: 「部屋」「バス」「屋外」という明確な利用シーンに合わせて、ユーザーが手動で機能を切り替えるUIを採用しています。これにより、ユーザーは現在の状況に合った情報を得ることができます。

#### 3. 特長 3
**指紋法による屋内測位**: 本システムでは屋内での測位精度を向上させるため、指紋法を採用しています。これは、利用者がキャリブレーション機能を使って部屋の複数地点の電波強度を実測し、その部屋専用のプロファイルを事前に作成する方式です。これにより、電波の反射など環境に応じた位置特定が可能になります。


### 解決出来ること

- 子供や高齢者の部屋や建物からの離脱の検知
- バスへの置き去りの検知トラッカー

### 今後の展望

- ビーコンを持ち運んでいるとし、ビーコンからトラッカー所持者らが一定の範囲内にいるかを確認できる機能
- 親トラッカー(GPS 機能あり)を 1 つ以上決め、他の子トラッカーが親トラッカーから離れていないか確認する機能

### 注力したこと（こだわり等）

- 部屋に設置
-

## 開発技術

### 活用した技術

- LoRaWAN
- bluetooth による位置推定

#### API・データ

- LoRa デバイスにより取得
- RSSI
- GNSS
- 3 点加速度

#### フレームワーク・ライブラリ・モジュール

- OSS
  - ChirpStack : LoRaWAN ネットワーク用のオープンソースのネットワークサーバー
- フレームワーク
  - TypeScript
  - react
  - Google Cloud Plattform
  - Firebase

#### デバイス

- MM-BLEBC4 (BLE ビーコン)
- senseCAP M2 (LoRa ゲートウェイ)
- senseCAP T1000 (LoRa デバイス)
- rasberry pi (LoRa ネットワークサーバ)

### 独自技術

- 10km まで通信可能な LoRa 通信
- BLE（3 点測量）
- IoT とクラウドの連携
  - BLE→LoRa→LNS→cloud というパイプライン処理

#### ハッカソンで開発した独自機能・技術

- 指紋法 + 3 点測量(距離)による RSSI による位置推定
- 機能 1 において、新規部屋でも動的にキャリブレーションできる機能
- データレートを低レートに固定化
  - 現在主流の自動データレート設定(ADR)は,ネットワークの状態によりデータレートを変更するため同じ位置でも受信電力(RSSI)が変動
  - 高データレートでは高速だが、ノイズに弱い
